---
title: 'Statistics Assignment #10'
author: "Naeem Chowdhury"
date: "6/26/2020"
output: pdf_document
---


##1. Setup
### options
Set up global options
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(tidy=TRUE)
knitr::opts_chunk$set(tidy.opts=list(width.cutoff=70))
knitr::opts_chunk$set(fig.height=4, fig.width=6)
```

### libraries
Load in needed libraries 
```{r, include=FALSE}
library(tidyverse)
library(RColorBrewer)
library(ggplot2)
#library(haven)
#library(plotly)
#install.packages('rgl')
#library(rgl)
library(ISLR)
```

## 2. File management
### Create variables for directories
```{r file_management, include=FALSE}
project.dir <- getwd() #naeem
output.dir <- "/Output"
data.dir <- "C:/Users/Naeem Cho/Desktop/School Work/Statistical Inference/Datasets"
setwd(project.dir)
getwd()
```

## 3. Importing Data
```{r, echo = FALSE, include=FALSE}
advertising <- read_csv(file.path(data.dir, "Advertising.csv"))
```


# Problem #1

We will work on the familiar _Advertising_ data set.

  1. First, let's try using just the _TV_ budget to predict the _Sales_.
    a. Fit the $Sales \sim TV$ regression model, provde the residuals-vs-fitted plot. Is there an issue? If yes, how do we fix it? Proceed to modify the model in order to fix it.
    b. Having fixed the issue from part 1(a), check the residuals-vs-fitted plot for modified model. Are there any other issues with the plot now? If yes, proceed to modify the model in order to fix it (__Hint__: polynomial regression).
    c. For your finalized model from part 1(b), provide the QQ-norm plot. Does the fit look normal? If not quite, is it that big of a deal for inference purposes? Why?
    d. For your finalized model from part 1(b), provide the plot of the data along with fitted line/curve (make sure to __enumerate__ the points using _text()_ function, like I did with _us_statewide_crime_ in Slides 5.R) Indicate observations that appear to be: 1) regression outliers; 2) high-leverage; 3) influential outliers.
    e. From part 1(d), pick the observation you believe to be the most influential outlier. Proceed to fit the regression 1) __with__ and 2) __without__ that observation included. Report the __fitted equations, RSE, and__ $R^2$ values, __comment on differences observed. DON'T INCLUDE THE OUTPUT OF $R$ COMMANDS__ (eval = F).
    f. What do you think we should do with that observation? Why?
    
  2. Now, let's try using all advertisement media to predict the $Sales$.
    a. Fit the $Sales \sim TV + radio + newspaper$ regression model. Prior to any residual diagnostics, first conduct __variable selection__. Which predictor(s) was dropped (if any)?
    b. For the model resulting from part 2(a), provide the residuals-vs-fitted plot. Is there an issue? If yes, how do we fix it? Proceed to modify the model in order to fix it. Rinse and repeat until you get a model that appears appropriate.
    c. For your finalized model from part 2(b), while still possible, but visualization of the fitted hyper-plane gets tougher. If we can't visualize the fit, what should we utilize in order to identify 1) regression outliers; 2) high-leverage observations; 3) influential outliers? Proceed to do it.
    d. From part 2(c), pick the observation that shows up as the most  influential outlier. Proceed to fit the rgression 1) __with__ and 2) __without__ that observation included. Report the __fitted equations, RSE, and__ $R^2$ values, __comment on differences observed. DON'T INCLUDE THE OUTPUT OF $R$ COMMANDS.
    e. What do you think we should do with that observation? Why?
    
# Problem #2

  1. For _Carseats_ data set of _ISLR_ package, proceed to work on the following model:
  
  $$Sales \sim Income + Advertising + ShelveLoc + Urban$$
    a. Provide the full modeling equation (with assumptions on error terms).
    b. Proceed to check if hte model assumptions hold via diagnosing appropriate plots.
    c. Given your answer in part 1(b), can we rely on $p$-values provided by classic inference here? Proceed to interpret two most statistically significant effects.
    
  2. For _Boston_ data set of _ISLR_ package, proceed to work on the following model:
  
  $$medv \sim crim + rm + lstat$$
    a. Provide the full modeling equation (with assumptions on error terms).
    b. Proceed to check if the model assmptions hold via diagnosing appropriate plots. If they don't, proceed to adjust the model in some ways in order to improve the fit. _Hint:_ Plot $medv$ against each predictor and diagnose if there's potentially a non-linear relationship.
    c. For the terms you've added in part 2(b) to the initial model from part 2(a), proceed to test the hypotheses for their statistical significance.
    
# Problem #3 (+3 Bonus Points)

For _thuesen_ data set of _ISwR_ library, proceed to use bootstrap in order to calculate standard errors and 95% confidence interval for $\hat{\beta}_1$ in the following regression:

$$short.velocity_i = \beta_0 + \beta_1 \cdot blood.glucose_i + \epsilon_i, \ \ \epsilon_i \sim_{i.i.d} N(0, \sigma^2)$$

Compare your results with the classic inference (obtained via fitting the model for full data set, no boostrapping). Did your conclusion about significance of blood glucose predictor differ at $\alpha = 0.05$ for bootstrap vs. classical approach? If  yes, why do you think that is?